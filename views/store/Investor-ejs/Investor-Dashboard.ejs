<%- include('../../partials/head') %>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 min-h-screen text-white">

<%- include('../../partials/Investor-nav') %>

<main class="min-h-screen pt-20 px-6 pb-10">
 <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
    
    <!-- Graph 1 -->
    <div class="bg-slate-800 p-4 rounded-xl shadow-xl">
        <h2 class="text-xl mb-2 font-semibold">Daily Transaction Volume</h2>
        <canvas id="transactionChart"></canvas>
    </div>

    <!-- Graph 2 -->
    <div class="bg-slate-800 p-4 rounded-xl shadow-xl">
        <h2 class="text-xl mb-2 font-semibold">Predicted Stock Prices</h2>
        <canvas id="predictionChart"></canvas>
    </div>

</div>

</main>

<script>
     // Prepare Data From Backend
    const dailyLabels = <%- JSON.stringify(dailyVolume.map(x => x.day)) %>;
    const dailyAmounts = <%- JSON.stringify(dailyVolume.map(x => x.totalAmount)) %>;

    const companyLabels = <%- JSON.stringify(predictions.map(x => x.registrationNumber)) %>;
    const companyPrices = <%- JSON.stringify(predictions.map(x => x.predictedPrice)) %>;

    // 1️⃣ Daily Transaction Volume (Line Chart)
    new Chart(document.getElementById('transactionChart'), {
        type: 'line',
        data: {
            labels: dailyLabels,
            datasets: [{
                label: 'Total Amount',
                data: dailyAmounts,
                borderColor: 'cyan',
                backgroundColor: 'rgba(0,255,255,0.2)',
                borderWidth: 2,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { labels: { color: 'white' } } },
            scales: {
                x: { ticks: { color: 'white' } },
                y: { ticks: { color: 'white' } }
            }
        }
    });

    // 2️⃣ Predicted Stock Prices (Bar Chart)
    new Chart(document.getElementById('predictionChart'), {
        type: 'bar',
        data: {
            labels: companyLabels,
            datasets: [{
                label: 'Predicted Price',
                data: companyPrices,
                backgroundColor: 'rgba(0,128,255,0.6)',
                borderColor: 'rgb(0,128,255)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { labels: { color: 'white' } } },
            scales: {
                x: { ticks: { color: 'white' } },
                y: { ticks: { color: 'white' } }
            }
        }
    });
</script>

</body>
</html>