<%- include('../../partials/head') %>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 min-h-screen text-white">

<%- include('../../partials/manager-nav') %>
<main class="flex-1 p-6 space-y-12">
 <!-- ================= INVESTORS ================= -->
    <section>
      <h1 class="text-3xl font-bold mb-6 text-center">Investor Management</h1>

      <!-- Search + Add -->
      <div class="flex justify-between mb-4">
        <form method="GET" action="/admin/investors/search" class="flex gap-2">
          <input type="text" name="query" placeholder="Search by Name or ID..." 
                 class="px-3 py-2 rounded-lg text-black" />
          <button type="submit" class="bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-700">Search</button>
        </form>

        <button onclick="openAddInvestorModal()" class="bg-green-600 px-4 py-2 rounded-lg hover:bg-green-700">
          Add Investor
        </button>
      </div>

      <!-- Investors Table -->
      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-700 rounded-lg">
          <thead class="bg-blue-800 text-white">
            <tr>
              <th class="px-4 py-2 border">Investor ID</th>
              <th class="px-4 py-2 border">Name</th>
              <th class="px-4 py-2 border">Contact</th>
              <th class="px-4 py-2 border">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (InvestorList && InvestorList.length > 0) { %>
              <% InvestorList.forEach(function(investor) { %>
                <tr class="border-b border-slate-700 hover:bg-slate-700">
                  <td class="py-2 px-4"><%= investor.id %></td>
                  <td class="py-2 px-4"><%= investor.name %></td>
                  <td class="py-2 px-4"><%= investor.contact %></td>
                  <td class="py-2 px-4 flex gap-2">
                    <button onclick='openEditInvestorModal(<%= JSON.stringify(investor) %>)'
                            class="bg-yellow-500 px-3 py-1 rounded-lg hover:bg-yellow-600">
                      Edit
                    </button>
                    <form action="/admin/investors/delete/<%= investor.id %>" method="POST">
                      <button type="submit" class="bg-red-600 px-3 py-1 rounded-lg hover:bg-red-700">
                        Delete
                      </button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr><td colspan="4" class="text-center py-4">No investors found</td></tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ================= STAKEHOLDERS ================= -->
    <section>
      <h1 class="text-3xl font-bold mb-6 text-center">Stakeholder Management</h1>

      <!-- Search + Add -->
      <div class="flex justify-between mb-4">
        <form method="GET" action="/admin/stakeholders/search" class="flex gap-2">
          <input type="text" name="query" placeholder="Search by Name or Email..." 
                 class="px-3 py-2 rounded-lg text-black" />
          <button type="submit" class="bg-blue-600 px-4 py-2 rounded-lg hover:bg-blue-700">Search</button>
        </form>

        <button onclick="openAddStakeholderModal()" class="bg-green-600 px-4 py-2 rounded-lg hover:bg-green-700">
          Add Stakeholder
        </button>
      </div>

      <!-- Stakeholders Table -->
      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-700 rounded-lg">
          <thead class="bg-blue-800 text-white">
            <tr>
              <th class="px-4 py-2 border">ID</th>
              <th class="px-4 py-2 border">Name</th>
              <th class="px-4 py-2 border">Email</th>
              <th class="px-4 py-2 border">Phone Number</th>
              <th class="px-4 py-2 border">Role</th>
              <th class="px-4 py-2 border">Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (StakeholderList && StakeholderList.length > 0) { %>
              <% StakeholderList.forEach(function(stakeholder) { %>
                <tr class="border-b border-slate-700 hover:bg-slate-700">
                  <td class="py-2 px-4"><%= stakeholder.id %></td>
                  <td class="py-2 px-4"><%= stakeholder.name %></td>
                  <td class="py-2 px-4"><%= stakeholder.email %></td>
                  <td class="py-2 px-4"><%= stakeholder.phoneNumber %></td>
                  <td class="py-2 px-4"><%= stakeholder.role %></td>
                  <td class="py-2 px-4 flex gap-2">
                    <button onclick='openEditStakeholderModal(<%= JSON.stringify(stakeholder) %>)'
                            class="bg-yellow-500 px-3 py-1 rounded-lg hover:bg-yellow-600">
                      Edit
                    </button>
                    <form action="/admin/stakeholders/delete/<%= stakeholder.id %>" method="POST">
                      <button type="submit" class="bg-red-600 px-3 py-1 rounded-lg hover:bg-red-700">
                        Delete
                      </button>
                    </form>
                  </td>
                </tr>
              <% }) %>
            <% } else { %>
              <tr><td colspan="6" class="text-center py-4">No stakeholders found</td></tr>
            <% } %>
          </tbody>
        </table>
      </div>
    </section>
  </div>




 <!-- ================= INVESTOR MODALS ================= -->
  <div id="addInvestorModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
    <div class="bg-slate-800 p-6 rounded-lg w-96">
      <h2 class="text-xl mb-4">Add Investor</h2>
      <form method="POST" action="/admin/investors/add">
        <input type="text" name="name" placeholder="Name" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="text" name="contact" placeholder="Contact Info" class="w-full p-2 mb-3 rounded text-black" required>
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeAddInvestorModal()" class="bg-gray-600 px-3 py-1 rounded-lg hover:bg-gray-700">Cancel</button>
          <button type="submit" class="bg-green-600 px-3 py-1 rounded-lg hover:bg-green-700">Save</button>
        </div>
      </form>
    </div>
  </div>

  <div id="editInvestorModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
    <div class="bg-slate-800 p-6 rounded-lg w-96">
      <h2 class="text-xl mb-4">Edit Investor</h2>
      <form id="editInvestorForm" method="POST">
        <input type="text" name="name" id="editInvestorName" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="text" name="contact" id="editInvestorContact" class="w-full p-2 mb-3 rounded text-black" required>
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeEditInvestorModal()" class="bg-gray-600 px-3 py-1 rounded-lg hover:bg-gray-700">Cancel</button>
          <button type="submit" class="bg-yellow-500 px-3 py-1 rounded-lg hover:bg-yellow-600">Update</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ================= STAKEHOLDER MODALS ================= -->
  <div id="addStakeholderModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
    <div class="bg-slate-800 p-6 rounded-lg w-96">
      <h2 class="text-xl mb-4">Add Stakeholder</h2>
      <form method="POST" action="/admin/stakeholders/add">
        <input type="text" name="name" placeholder="Name" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="email" name="email" placeholder="Email" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="tel" name="phoneNumber" placeholder="Phone Number" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="text" name="role" placeholder="Role" class="w-full p-2 mb-3 rounded text-black" required>
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeAddStakeholderModal()" class="bg-gray-600 px-3 py-1 rounded-lg hover:bg-gray-700">Cancel</button>
          <button type="submit" class="bg-green-600 px-3 py-1 rounded-lg hover:bg-green-700">Save</button>
        </div>
      </form>
    </div>
  </div>

  <div id="editStakeholderModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center">
    <div class="bg-slate-800 p-6 rounded-lg w-96">
      <h2 class="text-xl mb-4">Edit Stakeholder</h2>
      <form id="editStakeholderForm" method="POST">
        <input type="text" name="name" id="editStakeholderName" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="email" name="email" id="editStakeholderEmail" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="tel" name="phoneNumber" id="editStakeholderPhone" class="w-full p-2 mb-3 rounded text-black" required>
        <input type="text" name="role" id="editStakeholderRole" class="w-full p-2 mb-3 rounded text-black" required>
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeEditStakeholderModal()" class="bg-gray-600 px-3 py-1 rounded-lg hover:bg-gray-700">Cancel</button>
          <button type="submit" class="bg-yellow-500 px-3 py-1 rounded-lg hover:bg-yellow-600">Update</button>
        </div>
      </form>
    </div>
  </div>

</main>


<script>


// Investor Modals
    function openAddInvestorModal() { document.getElementById('addInvestorModal').classList.remove('hidden'); }
    function closeAddInvestorModal() { document.getElementById('addInvestorModal').classList.add('hidden'); }
    function openEditInvestorModal(investor) {
      document.getElementById('editInvestorName').value = investor.name;
      document.getElementById('editInvestorContact').value = investor.contact;
      document.getElementById('editInvestorForm').action = `/admin/investors/edit/${investor.id}`;
      document.getElementById('editInvestorModal').classList.remove('hidden');
    }
    function closeEditInvestorModal() { document.getElementById('editInvestorModal').classList.add('hidden'); }

    // Stakeholder Modals
    function openAddStakeholderModal() { document.getElementById('addStakeholderModal').classList.remove('hidden'); }
    function closeAddStakeholderModal() { document.getElementById('addStakeholderModal').classList.add('hidden'); }
    function openEditStakeholderModal(stakeholder) {
      document.getElementById('editStakeholderName').value = stakeholder.name;
      document.getElementById('editStakeholderEmail').value = stakeholder.email;
      document.getElementById('editStakeholderPhone').value = stakeholder.phoneNumber;
      document.getElementById('editStakeholderRole').value = stakeholder.role;
      document.getElementById('editStakeholderForm').action = `/admin/stakeholders/edit/${stakeholder.id}`;
      document.getElementById('editStakeholderModal').classList.remove('hidden');
    }
    function closeEditStakeholderModal() { document.getElementById('editStakeholderModal').classList.add('hidden'); }


</script>




  
</body>
</html>